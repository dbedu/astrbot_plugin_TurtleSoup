# Astr🐢 海龟汤推理游戏插件

一个为 AstrBot 开发的海龟汤推理游戏插件，让用户在聊天中体验经典的推理游戏。支持AI智能裁判和完整的题目管理系统，内置42个精选题目。

## 🌟 主要特色

- 🎯 **即开即玩**：无需复杂配置，内置丰富题库
- 🤖 **AI 裁判**：智能判断，精准回答"是/否/无关"  
- 📚 **题库管理**：42个精选题目，支持难度分级和标签分类
- 👥 **多用户**：支持多人同时游戏，会话完全隔离
- 🔄 **灵活操作**：支持换题、查看答案、游戏控制等功能

## 功能特点

🐢 **完整的题库管理系统**
- 📚 结构化题库，支持题号索引和分类（共42个精选题目）
- 🎯 支持按题号选择特定题目
- ⭐ 题目难度分级（1-5星）
- 🏷️ 题目标签分类系统
- 📋 题库浏览和详情查看

🎮 **丰富的游戏功能**
- 🎲 随机题目模式
- 🎯 指定题目模式
- 🤖 智能AI裁判，精准回答"是"、"否"或"无关"
- 🔄 游戏中换题功能
- 👁️ 提前查看答案功能

## 指令列表

### 基本游戏指令
| 指令 | 功能 | 示例 |
|------|------|------|
| `/开始海龟汤` | 随机开始新游戏 | `/开始海龟汤` |
| `/开始海龟汤 题号` | 选择特定题目开始游戏 | `/开始海龟汤 1` |
| `/结束海龟汤` | 主动结束游戏并查看答案 | `/结束海龟汤` |
| `/强制结束海龟汤` | 立即强制结束游戏 | `/强制结束海龟汤` |
| `/公布答案` | 查看答案但不结束游戏 | `/公布答案` |
| `/换一题` | 更换题目并重置提问次数 | `/换一题` |

### 题库管理指令
| 指令 | 功能 | 示例 |
|------|------|------|
| `/题库列表` | 查看题库第一页 | `/题库列表` |
| `/题库列表 页数` | 查看指定页的题目 | `/题库列表 2` |
| `/题目详情 题号` | 查看题目详细信息 | `/题目详情 1` |

### 帮助指令
| 指令 | 功能 | 示例 |
|------|------|------|
| `/海龟汤帮助` | 查看完整帮助信息 | `/海龟汤帮助` |

### 管理员指令
| 指令 | 功能 | 示例 |
|------|------|------|
| `/admin end turtle` | 强制结束所有游戏 | `/admin end turtle` |

## 游戏规则

1. **开始游戏**：使用 `/开始海龟汤` 随机开始，或 `/开始海龟汤 题号` 选择特定题目
2. **题目展示**：系统会给出一个看似不合理的情景描述
3. **提问推理**：玩家使用 `/海龟汤提问 你的问题` 格式提出问题
4. **AI回答**：AI只会回答"是"、"否"、"无关"、"请重新提问"或"很接近了"
5. **推理过程**：通过不断提问逐步缩小范围，推理出真相
6. **获胜条件**：正确说出完整答案或推理出核心真相
7. **游戏限制**：每局有20次提问机会和600秒思考时间

## 使用流程

### 快速开始
```
用户: /开始海龟汤
系统: 📖 谜题 #001 - 灯塔看守员 ⭐⭐⭐
      一个男人推开门，看到眼前的景象后立即跳楼自杀了。为什么？
      请使用 `/海龟汤提问 你的问题` 开始推理
      剩余提问次数：20

用户: /海龟汤提问 这是自杀吗？
系统: 💭 第 1 问
      ❓ 这是自杀吗？
      💡 是
      📊 剩余: 19 次

用户: /海龟汤提问 他是因为愧疚而自杀的吗？
系统: 💭 第 2 问
      ❓ 他是因为愧疚而自杀的吗？
      💡 是
      📊 剩余: 18 次
```

### 题库浏览
```
用户: /题库列表
系统: 📚 海龟汤题库 (第 1/5 页)

      #001 灯塔看守员 ⭐⭐⭐
      一个男人推开门，看到眼前的景象后立即...

      #002 海龟汤 ⭐⭐⭐⭐
      一个女人在餐厅点了一份海龟汤，喝了一口...

      使用 `/开始海龟汤 题号` 来选择特定题目
      使用 `/题库列表 页数` 查看其他页面
```


## 题库说明

本插件内置42个精选海龟汤题目，涵盖以下类型：
- 🔍 **经典推理**：灯塔看守员、海龟汤等经典题目
- 👻 **恐怖悬疑**：绿牙、作家、饺子等惊悚题材
- 💝 **温情故事**：外婆的苹果、奶奶的橘子树等感人故事
- 🧩 **逻辑谜题**：数数、几节、音乐等逻辑推理
- 🔪 **犯罪推理**：小红裙、夺爱、好孩子等犯罪题材

### 题库结构
所有题目存储在 `questions_database.txt` 文件中，格式如下：

```
ID: 001
标题: 灯塔看守员
汤面: 一个男人推开门，看到眼前的景象后立即跳楼自杀了。为什么？
汤底: 这个男人是灯塔管理员，他发现灯塔的灯灭了，意识到因为自己的疏忽导致船只失事，愧疚之下选择了跳楼。
难度: 3
标签: 经典,自杀,责任

---
```

### 添加新题目
1. 在 `questions_database.txt` 文件末尾添加新题目
2. 按照上述格式填写所有字段
3. 使用 `---` 分隔不同题目
4. 重启插件生效

## 安装使用

### 安装方法
1. 下载插件文件到 AstrBot 的插件目录
2. 重启 AstrBot 或使用热加载功能
3. 使用 `/海龟汤帮助` 查看详细使用说明

### 配置说明
插件支持以下配置项（在 `_conf_schema.json` 中定义）：
- `session_timeout`: 游戏会话超时时间（默认600秒）
- `max_questions`: 每局最大提问次数（默认20次）

## 推理技巧

### 提问策略
1. **确定事件性质**
   - "这是意外吗？"
   - "这是自杀吗？"
   - "涉及谋杀吗？"

2. **缩小范围**
   - "涉及其他人吗？"
   - "发生在室内吗？"
   - "时间重要吗？"

3. **关注细节**
   - "这个人的职业重要吗？"
   - "死因和看到的景象有关吗？"
   - "这个人之前发生过什么？"

4. **推理验证**
   - "他是因为愧疚而死的吗？"
   - "这件事是他自己造成的吗？"
   - "答案是他是灯塔管理员吗？"

### 常见错误
- ❌ 问题过于具体，缺乏推理过程
- ❌ 一次性猜测多个答案
- ❌ 忽略题目中的关键词
- ✅ 循序渐进，逐步缩小范围
- ✅ 基于已知信息进行逻辑推理

## 技术特点

- 🏗️ **框架集成**：基于 AstrBot 插件框架开发
- 🤖 **AI 驱动**：使用 LLM 提供智能的游戏裁判体验
- 👥 **多用户支持**：支持多用户同时游戏，会话完全隔离
- 🛡️ **健壮设计**：完善的错误处理和会话管理机制
- ⚙️ **高度可配置**：支持自定义游戏参数和题库管理
- 📚 **丰富题库**：内置42个精选题目，涵盖多种类型
- 🔄 **实时交互**：支持游戏中换题、查看答案等灵活操作

## 版本历史

### v1.0.0 (2025-01-29)
- ✨ 完整的海龟汤游戏功能
- 🗃️ 内置42个精选题目
- 🤖 AI智能裁判系统
- 👥 多用户并发支持
- 🎯 题库管理和浏览功能
- 🔧 健壮的会话管理机制
- 📖 完善的帮助和文档系统

### 致谢
本插件在开发过程中参考了以下优秀项目：
- [@oyxning/astrbot_plugin_textadventure](https://github.com/oyxning/astrbot_plugin_textadventure) - 会话管理和代码架构设计

### 贡献
欢迎提交 Issue 和 Pull Request 来改进这个插件：
- 🐛 报告 Bug
- 💡 提出新功能建议  
- 📚 贡献新的海龟汤题目
- 📖 改进文档

## 📚 相关链接

- 🏠 [AstrBot 官网](https://astrbot.app)
- 📖 [AstrBot 文档](https://astrbot.app/docs)
- 💬 [问题反馈](https://github.com/anchorAnc/astrbot_plugin_TurtleSoup/issues)

**如果这个插件对你有帮助，请给个⭐Star支持一下！**
